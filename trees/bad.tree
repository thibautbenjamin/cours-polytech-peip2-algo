\def\Cppcode[content]{\tex{
\usepackage{listings}

\lstset{
language=C++,
frame=single,
numbers=left,
numbersep=5pt,
showspaces=false,
showstringspaces=false,
tabsize=2}
}{\content}}

\def\cpp[content]{\Cppcode{
\begin{lstlisting}
\content
\end{lstlisting}
}}